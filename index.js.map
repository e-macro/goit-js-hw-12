{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nexport default async function getImagesByQuery(query, page = 1) {\nconst API_KEY = \"50767734-ec8f632e6fcf50a626b02f32f\";\n\nconst params = new URLSearchParams({\n    key: API_KEY,\n    q: query,\n    page: page,\n    per_page: 15,\n    image_type: \"photo\",\n    orientation: \"horizontal\",\n    safesearch: true,\n});\n\nconst response = await axios.get(`https://pixabay.com/api/`, { params })\n\nreturn response.data\n}","// Описаний у документації\nimport SimpleLightbox from \"simplelightbox\";\n// Додатковий імпорт стилів\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst loader = document.querySelector(\".loader\");\nconst gallery = document.querySelector(\".gallery\");\nconst loadMoreBtn = document.querySelector(\".load-more-btn\");\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n    captionDelay: 250, \n    captionPosition: 'bottom', \n    captionsData: 'alt'});\n\nexport default function createGallery(images) {\n    const createMarkup = images.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => `\n    <li class=\"image-box\">\n        <a href=\"${largeImageURL}\">\n        <img src=\"${webformatURL}\" alt=\"${tags}\" width=\"300\">\n        </a>\n        <div class=\"image-stats\">\n            <div class=\"image-stat\">\n                <span class=\"label\">Likes</span>\n                <span class=\"value\">${likes}</span>\n            </div>\n            <div class=\"image-stat\">\n                <span class=\"label\">Views</span>\n                <span class=\"value\">${views}</span>\n            </div>\n            <div class=\"image-stat\">\n                <span class=\"label\">Comments</span>\n                <span class=\"value\">${comments}</span>\n            </div>\n            <div class=\"image-stat\">\n                <span class=\"label\">Downloads</span>\n                <span class=\"value\">${downloads}</span>\n            </div>\n        </div>\n    </li>`).join(\"\");\n\n    gallery.insertAdjacentHTML(\"beforeend\", createMarkup);\n    lightbox.refresh();\n};\n\nexport function clearGallery() {\n    gallery.innerHTML = \"\";\n}\n\nexport function showLoader() {\n    loader.classList.remove(\"hidden\");\n}\n\nexport function hideLoader() {\n    loader.classList.add(\"hidden\");\n}\n\nexport function showLoadMoreButton () {\n    loadMoreBtn.classList.remove(\"hidden\");\n}\n\nexport function hideLoadMoreButton () {\n    loadMoreBtn.classList.add(\"hidden\")\n}\n\n\n","import getImagesByQuery from \"./js/pixabay-api\";\nimport createGallery, { clearGallery, showLoader, hideLoader, showLoadMoreButton, hideLoadMoreButton } from \"./js/render-functions\";\nimport iziToast from \"izitoast\";\n// Додатковий імпорт стилів\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nconst form = document.querySelector(\".form\");\nconst loadMoreBtn = document.querySelector(\".load-more-btn\");\n\nlet q = '';\nlet page = 1;\nlet totalHits = 0;\nlet loadedHits = 0;\n\nform.addEventListener('submit', async (event) => {\n    event.preventDefault();\n    q = event.target.elements['search-text'].value.trim();\n    if (q === \"\") {\n        iziToast.error({\n                    message: \"Please, fill in the field!\",\n                    closeOnClick: true,\n                    position: \"topRight\",\n                });\n        \n        return;\n    }\n    page = 1;\n    clearGallery()\n    showLoader()\n    await loadGallery()\n})\n\nloadMoreBtn.addEventListener(\"click\", async () => {\n    showLoader();\n    await loadGallery();\n    const imageBoxes = document.querySelectorAll('.image-box')\n    if (imageBoxes.length) {\n        const firstBox = imageBoxes[0];\n        const height = firstBox.getBoundingClientRect().height;\n        console.log(height);\n        \n        window.scrollBy({\n            top: height * 3,\n            behavior: \"smooth\",\n        });\n    }\n}\n)\n\nconst loadGallery = async () => {\n    try {\n        hideLoadMoreButton();\n        const response = await getImagesByQuery(q, page);\n        if (page === 1) {\n            totalHits = response.totalHits;\n            loadedHits = 0;\n            if (!response.hits.length) {\n            iziToast.error({\n                message: \"Sorry, there are no images matching your search query. Please try again!\",\n                closeOnClick: true,\n                position: \"topRight\",\n            });\n            return;\n            }\n        }\n\n        createGallery(response.hits);\n\n        page++;\n        loadedHits += response.hits.length;\n\n        if(loadedHits >= totalHits) {\n            hideLoadMoreButton();\n            iziToast.error({\n            message: \"We're sorry, but you've reached the end of search results.\",\n            closeOnClick: true,\n            position: \"topRight\",\n        });\n        } else {\n            showLoadMoreButton();\n        }\n        \n    }\n    catch (error) {\n        iziToast.error({\n            message: `${error}`\n        })\n    } finally {\n        hideLoader();\n    }\n}\n\n"],"names":["getImagesByQuery","query","page","API_KEY","params","axios","loader","gallery","loadMoreBtn","lightbox","SimpleLightbox","createGallery","images","createMarkup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","form","q","totalHits","loadedHits","event","iziToast","loadGallery","imageBoxes","height","response","error"],"mappings":"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"}